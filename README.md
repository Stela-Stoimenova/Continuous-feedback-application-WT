# Continuous Feedback Application

A real-time web application that enables students to provide anonymous, continuous feedback during lectures and tutorials through an intuitive emoticon-based interface.

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Database Design](#database-design)
- [Technology Stack](#technology-stack)
- [API Endpoints](#api-endpoints)
- [Development Workflow](#development-workflow)
- [Project Stages](#project-stages)
- [Application Structure](#application-structure)

## Overview

This Single Page Application (SPA) allows professors to create feedback sessions for their courses or tutorials. Students join these sessions using unique access codes and provide real-time feedback through four emoticon options (happy, bored, surprised, confused). All feedback is completely anonymous, timestamped, and visualized in real-time on the professor's dashboard.

The application is accessible from any browser on desktop, mobile devices, or tablets.

## Features and functionalities

### Professor Capabilities
- Sign up for an account
- Authenticate via login system
- Create feedback activities with unique access codes
- Set specific time windows for activity availability
- View live feedback streams during sessions
- Access historical feedback data after sessions end

### Student Capabilities
- Join activities anonymously using access codes
- Submit unlimited feedback instances during active sessions
- Select from four emotional states (happy, bored, surprised, confused)
- Participate from any device with a browser

## Database Design

The application uses a minimal three-entity relational database design that satisfies all core functional requirements.

![Continuous Feedback - ER Model](Screenshot%202025-11-24%20104103.png)

### Entity Relationship Overview

**User** (Professor/Admin) - Represents the instructor creating and managing activities

**Activity** (Primary Object) - The feedback session linking professors to feedback events

**Feedback** (Core Data) - Individual anonymous feedback submissions

### Database Schema

#### User Table

| Field          | Type   | Constraints                          |
|----------------|--------|--------------------------------------|
| id             | UUID   | PRIMARY KEY                           |
| email          | VARCHAR | UNIQUE, NOT NULL                     |
| name           | VARCHAR | NOT NULL                              |
| password_hash  | VARCHAR | NOT NULL                              |
| role           | ENUM('PROFESSOR', 'ADMIN') | NOT NULL          |

**Notes:**
- `password_hash` stores a secure hash of the professor’s password.
- Passwords are never stored in plain text.

#### Activity Table

| Field | Type | Constraints |
|-------|------|-------------|
| id | UUID | PRIMARY KEY |
| professor_id | UUID | FOREIGN KEY → User(id), ON DELETE CASCADE |
| access_code | VARCHAR(10) | UNIQUE, NOT NULL |
| starts_at | TIMESTAMPTZ | NOT NULL |
| ends_at | TIMESTAMPTZ | NOT NULL |

**Constraints:** CHECK (starts_at < ends_at)

**Indexes:** 
- (access_code) - for fast code validation
- (professor_id, starts_at) - for efficient activity listing

**Note:** Access code comparison should be case-insensitive.

#### Feedback Table

| Field | Type | Constraints |
|-------|------|-------------|
| id | UUID | PRIMARY KEY |
| activity_id | UUID | FOREIGN KEY → Activity(id), ON DELETE CASCADE |
| emotion_type | SMALLINT | NOT NULL, CHECK (emotion_type IN (1,2,3,4)) |
| created_at | TIMESTAMPTZ | DEFAULT now(), NOT NULL |
| anonymous_session_id | VARCHAR(64) | NULL |

**Emotion Types:** 1 = Happy, 2 = Bored, 3 = Surprised, 4 = Confused

**Indexes:**
- (activity_id, created_at) - optimizes timeline queries for live feedback display
- (activity_id, anonymous_session_id) - enables rate limiting and unique participant counting

### Anonymous Session ID Explained

The `anonymous_session_id` is a unique identifier generated by each student's device when joining an activity. This approach preserves complete anonymity while enabling:

- Counting distinct participants without identifying individuals
- Implementing rate limiting to prevent spam
- Analyzing participation patterns per device per session

The token is both "per-device" and "per-activity," ensuring complete isolation between different feedback sessions.

### Index Strategy Rationale

Two indexes on the Feedback table serve distinct purposes:

**Index 1: (activity_id, created_at)**
Used when professors view the live feedback timeline. Enables efficient chronological retrieval of all feedback for a given activity.

**Index 2: (activity_id, anonymous_session_id)**
Supports rate-limiting operations and participant analysis. Allows quick lookup of feedback frequency per anonymous student within time windows.

## Technology Stack

### Frontend
- **React.js** - Component-based SPA framework, studied in course curriculum
- **Tailwind CSS** - Utility-first styling for rapid UI development
- **HTTP Polling** - Periodic requests to fetch feedback updates (reliable and simple)
- **Socket.io**  - WebSocket implementation for true real-time data streaming

### Backend
- **Node.js** - JavaScript runtime environment (mandatory)
- **Express.js** - RESTful API framework
- **Sequelize ORM** - Database abstraction layer with built-in SQL injection protection
- **PostgreSQL** - Production relational database (SQLite for development)


## API Endpoints

### Authentication

```
POST /auth/login
POST /auth/signup
```
Authenticates a professor and returns a session token.

### Activity Management
```
POST /api/activities
```
Creates a new feedback activity (requires authentication).

```
GET /api/activities/:code
```
Validates an access code and returns activity details to students.

### Feedback Operations
```
POST /api/feedback
```
Submits an anonymous feedback instance for a specific activity. Triggers WebSocket broadcast if real-time mode is active.

```
GET /api/feedback/:activityId?since=timestamp
```
Returns the latest feedback data for the professor. Used by polling to display continuous feedback updates.

### Real-Time (Optional)
```
WebSocket / Socket.io channel
```
Provides a live data stream to the professor dashboard, sending new feedback events instantly when received.

## Development Workflow

### Branch Strategy

**IMPORTANT:** Never commit directly to main/master branch. All development must occur on feature branches.

**Workflow:**
1. Create a feature branch from main: `git checkout -b feature/feature-name`
2. Implement changes with descriptive commits
3. Test locally before pushing
4. Push to remote: `git push origin feature/feature-name`
5. Create pull request for code review
6. Merge to main after approval

**Branch Naming Convention:**
- Feature branches: `feature/description`
- Bug fixes: `fix/issue-description`
- Documentation: `docs/description`

### Setup Instructions

**Prerequisites:**
- Node.js (v16 or higher)
- PostgreSQL (v12 or higher)
- npm or yarn package manager

**Backend Setup:**
```bash
cd backend
npm install
```

Create a `.env` file in the backend directory:
```env
DB_NAME=continuous_feedback_db
DB_USER=postgres
DB_PASSWORD=your_password
DB_HOST=localhost
DB_PORT=5432
JWT_SECRET=your_secret_key_here
NODE_ENV=development
PORT=3000
```

Run database migrations:
```bash
npm run migrate
```

Start the development server:
```bash
npm run dev
```

**Frontend Setup:**
```bash
cd frontend
npm install
npm run dev
```

The frontend will be available at `http://localhost:5173` and will connect to the backend at `http://localhost:3000`.

### Emoticon Configuration

```javascript
const emotions = [
  { type: 'happy', label: 'Happy', value: 1 },
  { type: 'sad', label: 'Bored', value: 2 },
  { type: 'surprised', label: 'Surprised', value: 3 },
  { type: 'confused', label: 'Confused', value: 4 }
];
```

Render these in a 2x2 CSS grid layout. On click, submit feedback to the POST /api/feedback endpoint.

### Routing Structure

Each page corresponds to a route:
- `/login` - Professor authentication
- `/signup` - Professor registration
- `/professor/create` - Create new activity
- `/professor/activities` - View activity list
- `/professor/activity/:id` - Live feedback dashboard
- `/student/join` - Enter access code
- `/student/feedback/:activityId` - Submit feedback

**Protected Routes:**
Professor-only routes are protected by authentication middleware. Unauthenticated access redirects to the login page.

### External API Integration

The application integrates with the **ZenQuotes API** to display motivational quotes on the main interface. This fulfills the requirement of accessing data from an external service.

**Implementation:**
- Endpoint: `GET /api/quotes/quote`
- Backend proxies requests to `https://zenquotes.io/api/random`
- Quotes are displayed in the QuoteBanner component
- Provides inspirational messages to enhance user experience

## Project Stages

### Stage 1: Foundation & Core Features
- Database schema design and implementation
- Backend API with Express and Sequelize
- JWT authentication system
- Frontend React application with Tailwind CSS
- Activity creation and management
- Anonymous feedback submission
- Basic professor dashboard

### Stage 2: Real-Time Features
- Socket.io integration for live feedback updates
- Real-time dashboard with instant feedback display
- WebSocket connection management
- Live participant tracking
- External API integration (ZenQuotes)

### Stage 3: Production Deployment
- Production configuration for single-server deployment
- Environment-based API URL configuration
- Static file serving from backend
- PostgreSQL production setup with SSL
- Railway deployment in progress
- Database migrations on production
- Environment variables configuration

## Application Structure

### Backend Architecture

```
backend/
├── app.js                 # Express server setup & configuration
├── config/
│   └── config.js          # Database configuration (dev/test/prod)
├── controllers/
│   ├── activityController.js    # Activity CRUD operations
│   ├── authController.js        # Login/signup logic
│   ├── feedbackController.js    # Feedback submission & retrieval
│   └── quoteController.js       # External API proxy
├── middleware/
│   ├── authMiddleware.js        # JWT validation
│   ├── roleMiddleware.js        # Role-based access control
│   ├── validateMiddleware.js    # Request validation
│   └── errorHandler.js          # Global error handling
├── migrations/
│   ├── 20251219000001-create-user.js
│   ├── 20251219000002-create-activity.js
│   └── 20251219000003-create-feedback.js
├── models/
│   ├── index.js           # Sequelize initialization
│   ├── user.js            # Professor/admin model
│   ├── activity.js        # Feedback session model
│   └── feedback.js        # Anonymous feedback model
├── routes/
│   ├── authRoutes.js      # Authentication endpoints
│   ├── activityRoutes.js  # Activity management
│   ├── feedbackRoutes.js  # Feedback operations
│   └── quoteRoutes.js     # External API routes
├── services/
│   ├── authService.js     # Business logic for auth
│   ├── activityService.js # Business logic for activities
│   ├── feedbackService.js # Business logic for feedback
│   └── quoteService.js    # External API integration
├── dist/                  # Frontend build (production)
├── .env                   # Environment variables
└── package.json           # Dependencies & scripts
```

### Frontend Architecture

```
frontend/
├── src/
│   ├── main.jsx           # Application entry point
│   ├── App.jsx            # Root component & routing
│   ├── index.css          # Global styles & Tailwind
│   ├── components/
│   │   ├── Navbar.jsx            # Navigation component
│   │   ├── PrivateRoute.jsx      # Route protection
│   │   └── QuoteBanner.jsx       # Motivational quotes
│   ├── context/
│   │   └── AuthContext.jsx       # Global auth state
│   ├── pages/
│   │   ├── auth/
│   │   │   ├── Login.jsx         # Professor login
│   │   │   └── Signup.jsx        # Professor registration
│   │   ├── professor/
│   │   │   ├── Activities.jsx         # Activity list
│   │   │   ├── CreateActivity.jsx     # New activity form
│   │   │   ├── ActivityDashboard.jsx  # Live feedback view
│   │   │   └── ProfessorLayout.jsx    # Professor page layout
│   │   └── student/
│   │       ├── StudentJoin.jsx        # Enter access code
│   │       └── StudentFeedback.jsx    # Submit feedback
│   ├── services/
│   │   ├── api.js         # Axios HTTP client
│   │   └── socket.js      # Socket.io client
│   └── utils/
│       ├── dateUtils.js   # Date formatting helpers
│       ├── emoticons.js   # Emotion type mappings
│       └── sessionId.js   # Anonymous session generation
├── index.html             # HTML template
├── vite.config.js         # Vite bundler configuration
├── tailwind.config.js     # Tailwind CSS setup
└── package.json           # Dependencies & scripts
```

### Key Design Patterns

**Backend:**
- **MVC Architecture** - Separation of routes, controllers, and business logic
- **Service Layer** - Business logic isolated from HTTP handling
- **Middleware Chain** - Authentication, validation, and error handling
- **Repository Pattern** - Database operations through Sequelize models

**Frontend:**
- **Component-Based** - Reusable UI components with React
- **Context API** - Global state management for authentication
- **Protected Routes** - Role-based access control
- **Service Abstraction** - Centralized API and Socket.io clients

### Deployment Architecture

**Development Mode:**
- Frontend: Vite dev server on port 5173
- Backend: Express server on port 3000
- Separate processes for hot-reloading

**Production Mode:**
- Single Node.js server on port 3000 (or Railway-assigned)
- Backend serves compiled frontend from `/dist`
- All API routes prefixed with `/api`
- Socket.io shares HTTP server instance
- Static assets cached for performance

### Security Considerations

- **Password Security** - bcrypt hashing with salt rounds
- **JWT Authentication** - Tokens expire after 1 hour
- **SQL Injection Protection** - Sequelize ORM parameterized queries
- **CORS Configuration** - Restricted origins in production
- **Input Validation** - express-validator middleware
- **Environment Variables** - Sensitive data never committed
- **Anonymous Sessions** - No personally identifiable information stored
- **SSL/TLS** - HTTPS enforced on production deployment

### Performance Optimizations

- **Database Indexes** - Optimized queries on activity_id and created_at
- **Connection Pooling** - Sequelize manages database connections
- **Real-Time Updates** - Socket.io reduces polling overhead
- **Static Asset Caching** - Browser caching for frontend files
- **Lazy Loading** - React components loaded on demand

---


